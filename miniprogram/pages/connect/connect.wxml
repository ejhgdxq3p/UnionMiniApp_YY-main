<!--connect.wxml-->
<view class="container" style="{{cards[currentTrackIndex].avatarUrl ? 'background-image: url('+cards[currentTrackIndex].avatarUrl+');' : ''}}">
  <!-- èƒŒæ™¯è™šåŒ–å±‚ -->
  <view class="background-blur"></view>
  
  <!-- èƒŒæ™¯æ˜Ÿæ˜Ÿ -->
  <block wx:for="{{stars}}" wx:key="id">
    <view 
      class="star" 
      style="left: {{item.x}}rpx; top: {{item.y}}rpx; width: {{item.size}}rpx; height: {{item.size}}rpx; opacity: {{item.opacity}};"
      data-id="{{item.id}}">
    </view>
  </block>
  
  <!-- è¿æ¥é¡µé¢å†…å®¹ -->
  <view class="content">
    <!-- logoå’Œæ£€ç´¢æ¡†åŒºåŸŸ -->
    <view class="header-area">
      <image class="union-logo" src="/images/uinon logo4.png" mode="aspectFit" bindtap="goToFuzzySearch"></image>
      <view class="search-bar" bindtap="goToFuzzySearch">
        <view class="search-text">æ‰¾åˆ°ä»–ï¼šè¾“å…¥å¿ƒåŠ¨ç¬é—´</view>
      </view>
      <view class="search-hint" bindtap="goToFuzzySearch">ä»–è¯´ä»–éª‘è¿‡å·è—çº¿ï¼Œæ›¾ç»å½“è¿‡å®¿èˆæ³¡é¢ç»é”€å•†</view>
    </view>
    
    <!-- å”±ç‰‡å°é¢åŒºåŸŸ - ä¸‹ç§»ä½ç½® -->
    <view class="vinyl-record" bindtap="goToAchievements">
      <view class="vinyl-disc" style="transform: rotate({{discRotation}}deg)">
        <!-- æ·»åŠ å”±ç‰‡é®ç½©ï¼Œä½¿å¤´åƒæˆä¸ºç¯å½¢ -->
        <view class="avatar-mask">
          <image class="vinyl-hole-avatar" 
               src="{{cards[currentTrackIndex].avatarUrl || '/assets/default-avatar.png'}}" 
               mode="aspectFill"></image>
        </view>
        <!-- å”±ç‰‡ä¸­å¿ƒæŒ–æ´ -->
        <view class="vinyl-hole"></view>
      </view>
    </view>
    
    <!-- æ­Œå•å¼åç‰‡åˆ—è¡¨ - ä¸‹ç§»ä½ç½® -->
    <scroll-view class="music-playlist" scroll-y="{{false}}" bindtouchstart="touchStart" bindtouchmove="touchMove" bindtouchend="touchEnd">
      <!-- åŠ è½½ä¸­æç¤º -->
      <view class="loading-container" wx:if="{{isLoading}}">
        <view class="loading-icon"></view>
        <text class="loading-text">åŠ è½½ä¸­...</text>
      </view>
      
      <!-- é”™è¯¯æç¤º -->
      <view class="error-container" wx:elif="{{loadError}}">
        <text class="error-text">{{loadError}}</text>
        <view class="retry-btn" bindtap="getInteractionCards">é‡è¯•</view>
      </view>
      
      <!-- ç©ºçŠ¶æ€æç¤º -->
      <view class="empty-container" wx:elif="{{cards.length === 0}}">
        <view class="empty-icon">ğŸµ</view>
        <text class="empty-text">æš‚æ— ç¤¾äº¤æ­Œå•</text>
        <text class="empty-subtext">ä¸ä»–äººäº’åŠ¨åï¼Œæ­Œå•å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</text>
      </view>
      
      <!-- æ­Œå•åˆ—è¡¨ -->
      <view class="playlist-container" wx:else>
        <!-- é¡¶éƒ¨å¡«å…… -->
        <view class="list-padding"></view>
        
        <!-- å®ç°ç‰©ç†æ»šåŠ¨æ•ˆæœçš„è½¨é“ -->
        <view class="track-wheel" style="transform: translateY({{scrollOffset}}rpx)">
          <view class="track-item {{index === currentTrackIndex ? 'active' : ''}}" 
                wx:for="{{cards}}" 
                wx:key="index"
                style="opacity: {{1 - 0.12 * Math.abs(index - currentTrackIndex)}};"
                data-index="{{index}}"
                bindtap="viewTrackDetail">
            <!-- å¤§å‹ä¸“è¾‘å°é¢å¼å¤´åƒ -->
            <view class="album-cover-container">
              <view class="album-cover-placeholder" wx:if="{{!item.avatarUrl}}">
                <text>{{item.name ? item.name[0] : '?'}}</text>
              </view>
              <image class="album-cover" wx:if="{{item.avatarUrl}}" src="{{item.avatarUrl}}" mode="aspectFill"></image>
            </view>
            
            <view class="track-info">
              <view class="track-title">{{item.name || 'æœªçŸ¥åç§°'}}</view>
              <view class="track-artist">{{item.company || item.organization || 'æœªçŸ¥ç»„ç»‡'}}</view>
              
              <!-- æŠ€èƒ½æ ‡ç­¾ä½œä¸ºæ­Œæ›²é£æ ¼æ ‡ç­¾ -->
              <view class="track-tags" wx:if="{{item.skills && item.skills.length > 0}}">
                <view class="tag" wx:for="{{item.skills}}" wx:for-item="skill" wx:key="*this" wx:if="{{index < 2}}">
                  {{skill}}
                </view>
                <view class="tag-more" wx:if="{{item.skills.length > 2}}">+{{item.skills.length - 2}}</view>
              </view>
            </view>
          </view>
        </view>
        
        <!-- åº•éƒ¨å¡«å…… -->
        <view class="list-padding"></view>
      </view>
    </scroll-view>
  </view>
  
  <!-- åç‰‡é¢„è§ˆå¼¹çª— -->
  <view class="card-preview-modal" wx:if="{{showCardPreview}}">
    <view class="card-preview-content">
      <view class="card-preview-close" bindtap="closeCardPreview">Ã—</view>
      <view class="business-card">
        <view class="card-header">
          <image class="card-avatar" src="{{selectedCard.avatarUrl || '/assets/default-avatar.png'}}"></image>
          <view class="card-basic-info">
            <view class="card-name">{{selectedCard.name || 'æœªå¡«å†™å§“å'}}</view>
            <view class="card-position">{{selectedCard.position || 'æœªå¡«å†™èŒä½'}}</view>
            <view class="card-organization">{{selectedCard.organization || selectedCard.company || 'æœªå¡«å†™ç»„ç»‡'}}</view>
          </view>
        </view>
        <view class="card-divider"></view>
        <view class="card-body">
          <view class="card-intro">{{selectedCard.introduction || 'æœªå¡«å†™ä¸ªäººä»‹ç»'}}</view>
          <view class="card-skills" wx:if="{{selectedCard.skills && selectedCard.skills.length > 0}}">
            <view class="card-section-title">æŠ€èƒ½</view>
            <view class="card-tags">
              <view class="card-tag" wx:for="{{selectedCard.skills}}" wx:key="index">{{item}}</view>
            </view>
          </view>
          <view class="card-fields" wx:if="{{selectedCard.fields && selectedCard.fields.length > 0}}">
            <view class="card-section-title">é¢†åŸŸ</view>
            <view class="card-tags">
              <view class="card-tag" wx:for="{{selectedCard.fields}}" wx:key="index">{{item}}</view>
            </view>
          </view>
          <view class="card-contact" wx:if="{{selectedCard.contact}}">
            <view class="card-section-title">è”ç³»æ–¹å¼</view>
            <view class="card-contact-value">{{selectedCard.contact}}</view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view> 